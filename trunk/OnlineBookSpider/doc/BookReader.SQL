--   -------------------------------------------------- 
--   Generated by Enterprise Architect Version 7.5.845
--   Created On : 星期四, 02 十二月, 2010 
--   DBMS       : MySql 
--   -------------------------------------------------- 


SET FOREIGN_KEY_CHECKS=0;


--  Drop Tables, Stored Procedures and Views 
DROP TABLE IF EXISTS t_book_author
;
DROP TABLE IF EXISTS t_book_category
;
DROP TABLE IF EXISTS t_book_chapter
;
DROP TABLE IF EXISTS t_book_info
;

--  Create Tables 
CREATE TABLE t_book_author
(
	id BIGINT NOT NULL,
	name VARCHAR(255) NOT NULL,
	alias VARCHAR(255),
	seq INTEGER NOT NULL DEFAULT 99,
	profile TEXT,
	PRIMARY KEY (id)
) 
;


CREATE TABLE t_book_category
(
	id INTEGER NOT NULL,
	father_id INTEGER NOT NULL,
	name VARCHAR(255) NOT NULL,
	path VARCHAR(255) NOT NULL DEFAULT 99,
	seq INTEGER NOT NULL DEFAULT 99,
	PRIMARY KEY (id)
) 
;


CREATE TABLE t_book_chapter
(
	id BIGINT NOT NULL,
	father_id BIGINT COMMENT '多级章节时使用',
	book_id BIGINT NOT NULL,
	name VARCHAR(255) NOT NULL,
	update_time DATE NOT NULL,
	txt TEXT NOT NULL,
	html TEXT NOT NULL,
	url VARCHAR(255) NOT NULL,
	KEY (book_id)
) 
;


CREATE TABLE t_book_info
(
	id BIGINT NOT NULL,
	category_id INTEGER NOT NULL,
	author_id BIGINT NOT NULL,
	name VARCHAR(255) NOT NULL,
	alias VARCHAR(255),
	abstract TEXT NOT NULL,
	update_time DATE NOT NULL,
	url VARCHAR(255) NOT NULL COMMENT '抓取失败/更新使用',
	PRIMARY KEY (id),
	KEY (author_id),
	KEY (category_id)
) 
;



SET FOREIGN_KEY_CHECKS=1;


--  Create Foreign Key Constraints 
ALTER TABLE t_book_chapter ADD CONSTRAINT FK_t_book_chapter_t_book_info 
	FOREIGN KEY (book_id) REFERENCES t_book_info (id)
;

ALTER TABLE t_book_info ADD CONSTRAINT FK_t_book_info_t_book_author 
	FOREIGN KEY (author_id) REFERENCES t_book_author (id)
;

ALTER TABLE t_book_info ADD CONSTRAINT FK_t_book_info_t_book_category 
	FOREIGN KEY (category_id) REFERENCES t_book_category (id)
;
